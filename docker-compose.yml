version: '3.8'

services:
  app:
    build: .
    container_name: bhhv_app
    restart: always
    ports:
      - "3010:3000"  # Changed port to avoid conflicts
    environment:
      - NODE_ENV=production
      - MONGODB_URI=mongodb://admin:MongoPass123!@shared_mongodb:27017/bhhv_prod?authSource=admin
    networks:
      - db_network  # Use shared database network
    volumes:
      - ./scripts:/app/scripts

networks:
  db_network:
    external: true  # Use external shared network